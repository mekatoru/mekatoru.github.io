<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>My first blog</title>
    <url>/2025/12/17/My-first-blog/</url>
    <content><![CDATA[<h2 id="ğŸ“…-ä»Šæ—¥æ€è€ƒ"><a href="#ğŸ“…-ä»Šæ—¥æ€è€ƒ" class="headerlink" title="ğŸ“… ä»Šæ—¥æ€è€ƒ"></a>ğŸ“… ä»Šæ—¥æ€è€ƒ</h2><p>ä»Šå¤©æ­å»ºåšå®¢è™½ç„¶é‡åˆ°äº†ä¸€ç‚¹å°æ³¢æŠ˜ï¼ˆNodeæ‰¾ä¸åˆ°è·¯å¾„ï¼‰ï¼Œä½†åœ¨é‡ç½®ç¯å¢ƒå˜é‡åç»ˆäºè§£å†³äº†ã€‚<br><strong>æ„Ÿæ‚Ÿï¼š</strong> é‡åˆ°æŠ¥é”™ä¸è¦æ…Œï¼Œçœ‹æ¸…æ¥šæç¤ºï¼Œä¸€æ­¥æ­¥æ’æŸ¥å°±æ˜¯è§£å†³é—®é¢˜çš„è¿‡ç¨‹ã€‚</p>
<h2 id="ğŸ’»-ä»£ç ç‰‡æ®µ"><a href="#ğŸ’»-ä»£ç ç‰‡æ®µ" class="headerlink" title="ğŸ’» ä»£ç ç‰‡æ®µ"></a>ğŸ’» ä»£ç ç‰‡æ®µ</h2><p>è¿™æ˜¯æˆ‘ä¸ºäº†æµ‹è¯•ç½‘é¡µæ˜¾ç¤ºä»£ç æ•ˆæœå†™çš„ Python ç¤ºä¾‹ï¼š</p>
<pre><code class="language-python"># è¿™æ˜¯ä¸€ä¸ªè®¡ç®—åœ†é¢ç§¯çš„å‡½æ•°
import math

def calculate_area(radius):
    if radius &lt; 0:
        return &quot;åŠå¾„ä¸èƒ½ä¸ºè´Ÿæ•°&quot;
    area = math.pi * (radius ** 2)
    return round(area, 2)

print(f&quot;åŠå¾„ä¸º5çš„åœ†é¢ç§¯æ˜¯: {calculate_area(5)}&quot;)
</code></pre>
]]></content>
  </entry>
  <entry>
    <title>try to set the picture and zip</title>
    <url>/2025/12/19/page/</url>
    <content><![CDATA[<h1 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h1><p>å°è¯•ä¸€ä¸‹æ”¾å›¾ç‰‡å’Œé“¾æ¥</p>
<p><img src="/images/background.jpg" alt="æˆ‘çš„èƒŒæ™¯å›¾ç‰‡"></p>
<p><a href="/download/helloworld.zip">ä¸‹è½½æŸä»£ç </a></p>
]]></content>
  </entry>
  <entry>
    <title>pytorch_custom_datasets</title>
    <url>/2025/12/18/pytorch-custom-datasets/</url>
    <content><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>éšä¾¿å†™ç‚¹ï¼ŒåŠ æ·±è®°å¿†</p>
<span id="more"></span>
<pre><code class="language-python">import torch
import torchvision
import torchvision.transforms as transforms
from pathlib import Path 
import os
from PIL import Image
from typing import Tuple,Dict,List
import numpy as np
import matplotlib.pyplot as plt
from torch import nn

 
def find_classes(dir:str)-&gt;Tuple[List[str],Dict[str,int]]:
    # 1. è·å–æ‰€æœ‰ç±»åˆ«æ–‡ä»¶å¤¹çš„åç§°
    classes = sorted(entry.name for entry in os.scandir(dir) if entry,is_dir())
    # 2.æ²¡æ‰¾åˆ°åˆ™æŠ¥é”™
    if not classes:
        raise FileNotFoundError(f&quot;Couldn&#39;t find any class folder in {dir}.&quot;)
    # 3. ç»™æ¯ä¸ªç±»åˆ«åˆ†é…ä¸€ä¸ªæ•°å­—ç´¢å¼•
    class_to_idx = {cls_name: i for i, cls_name in enumerate(classes)}
    return classes,class_to_idx

from torch.utils.data import Dataset

class ImageFolderCustom(Dataset):
    def __init__(self, targ_dir:str, transform=None)-&gt;None:
        #  Get all image paths
        self.paths = list(pathlib.Path(targ_dir).glob(&quot;*/*.jpg&quot;))
        # transforms
        self.transform = transform
        # Create class and class_to_idx
        self.classes,self.class_to_idx = find_classes(targ_dir)

    def load_image(self,index:int)-&gt;Image.Image:
        image_path = self.paths[index]




import torch 
from torchvision import datasets
simple_transform = transforms.Compose([
    transforms.Resize(64,64),
    transforms.ToTensor(),
])
# tran_dir å°±æ˜¯å›¾ç‰‡æ‰€åœ¨è·¯å¾„
train_data_simple = datasets.ImageFolder(root=train_dir,transform=simple_transform)
test_data_simple = datasets.ImageFolder(root=test_dir,
transform=simple_transform)

import os
from torch.utils.data import DataLoader

BATCH_SIZE = 32
NUM_WORKERS = os.cpu_count()

train_loader_simple = DataLoader(train_data_simple,
batch_size=BATCH_SIZE,
shuffle=True,
num_workers=NUM_WORKERS) 
test_loader_simple = DataLoader(test_data_simple,
batch_size=BATCH_SIZE,
shuffle=False,
num_workers=NUM_WORKERS)

# æ„å»ºåŸºç¡€æ¨¡å‹
class TinyVGG(nn.Module):
    def __init__(self,input_shape:int,hidden_units:int,output_shape:int)-&gt;None:
        super().__init__()
        self.conv_block_1=nn.Sequential(
            nn.Conv2d(input_shape,hidden_units,kernel_size=3,stride=1,padding=1),
            nn.ReLU(),
            nn.Conv2d(hidden_units,hidden_units,kernel_size=3,
            stride=1,padding=1),
            nn.ReLU(),
            nn.MaxPool2d(kernel_size=2,stride=2)
        )
        self.conv_block_2=nn.Sequential(
            nn.Conv2d(hidden_units,hidden_units,kernel_size=3,
            stride=1,padding=1),
            nn.ReLU(),
            nn.Conv2d(hidden_units,hidden_units,kernel_size=3,
            stride=1,padding=1),
            nn.ReLU(),
            nn.MaxPool2d(kernel_size=2,stride=2)
        )
        self.classifier=nn.Sequential(
            nn.Flatten(),
            nn.Linear(hidden_units*16*16,output_shape)
        )
    def forward(self,x:torch.Tensor):
        return self.classifier(self.conv_block_2(self.conv_block_1(x)))

    # torch.info é‡Œçš„ summaryå¯ä»¥æŸ¥çœ‹æ¨¡å‹ä¿¡æ¯ summary(model,input_shape=[1,3,64,64]) å°±åƒè¿™æ ·

def train_step(model:nn.Module,
               dataloader:torch.utils.data.DataLoader,
               loss_fn:nn.Module,
               optimizer:torch.optim.Optimizer):
    model.train()
    train_loss,train_acc=0,0
    for batch,(X,y) in enumerate(dataloader):
        X,y=X.to(device),y.to(device)
        
        y_pred=model(X)

        loss=loss_fn(y_pred,y)
        train_loss+=loss.item()

        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        y_pred_class=torch.argmax(torch.softmax(y_pred,dim=1))
        train_acc+=(y_pred_class==y).sum().item()/len(y_pred)
    train_loss/=len(dataloader)
    train_acc/=len(dataloader)
    return train_loss,train_acc

def test_step(model:nn.Module,
              dataloader:torch.utils.data.DataLoader,
              loss_fn:nn.Module):
    model.eval()
    test_loss,test_acc=0,0

    with torch.inference_mode():
        for batch,(X,y) in enumerate(dataloader):
            X,y=X.to(device),y.to(device)

            test_pred_logits=model(X)

            loss=loss_fn(test_pred_logits,y)
            test_loss+=loss.item()

            test_pred_labels=test_pred_logits.argmax(dim=1)
            test_acc+=(test_pred_labels==y).sum().item()/len(test_pred_labels)
    test_loss/=len(dataloader)
    test_acc/=len(dataloader)
    return test_loss,test_acc
    # len(dataset)æ˜¯æ•°æ®æ€»æ•°ï¼Œlen(dataloader)æ˜¯æ‰¹æ¬¡æ€»æ•°
    
</code></pre>
]]></content>
      <categories>
        <category>pytorch</category>
      </categories>
      <tags>
        <tag>pytorch</tag>
        <tag>custom_datasets</tag>
      </tags>
  </entry>
  <entry>
    <title>Pytorch learning</title>
    <url>/2025/12/17/Pytorch-learning/</url>
    <content><![CDATA[<h2 id="Pytorch-learning"><a href="#Pytorch-learning" class="headerlink" title="Pytorch learning"></a>Pytorch learning</h2><h3 id="04-pytorch-custom-datasets"><a href="#04-pytorch-custom-datasets" class="headerlink" title="04_pytorch_custom_datasets"></a>04_pytorch_custom_datasets</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pytoch_custom_datasets&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><input disabled="" type="checkbox"> å­¦ä¹ è¿™éƒ¨åˆ†</li>
<li><input checked="" disabled="" type="checkbox"> ä¸Šè¯¾</li>
<li>æ— èŠ</li>
</ul>
<span id="more"></span>

<blockquote>
<p>ä¸´è¿‘æœŸæœ«ï¼Œä»¤äººæ„Ÿæ…¨ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>Pytorch</category>
      </categories>
      <tags>
        <tag>Pytorch</tag>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>try the sticky:1</title>
    <url>/2025/12/17/try-the-sticky-1/</url>
    <content><![CDATA[<h2 id="try-the-sticky-1"><a href="#try-the-sticky-1" class="headerlink" title="try the sticky:1"></a>try the sticky:1</h2><p>This is the first post with sticky:1.<br>æˆ‘åªæ˜¯è¯•ä¸‹ç½®é¡¶åŠŸèƒ½ï¼Œçœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚</p>
]]></content>
  </entry>
</search>
